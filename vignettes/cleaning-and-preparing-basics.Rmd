---
title: "Cleaning and Preparing Data: The Basics"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Cleaning and Preparing Data: The Basics}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

In this tutorial we will work through the basic steps of loading and cleaning a
single data file that represents one "entity". By this we mean one table of data
that describes one thing, e.g. a household, or a study participant. If you have a
file of data that describes study participants *and* the households they belong
to (most likely redundantly with data in household columns repeated), then
this is a **multi-entity situation** that we will cover later.

```{r setup}
library(tidyverse)
library(knitr)
# during development
devtools::load_all()
# or
# library(study.wrangler)
```

So let's start loading a tab-delimited file of toy data. Here we get the location
of the file from the data bundled with this package. You can simply provide
a relative or absolute path to any tab-delimited data file.

```{r}

households_file_path <- system.file("extdata", "toy_example/households.tsv", package = 'study.wrangler')
households_file_path

```
Now let's load it in with one of the wrangler's main functions:

```{r}

households <- entity_from_file(households_file_path)

```

If there are no warnings or errors, we now have an "entity object": `households`.

We can use the wrangler's `inspect()` function to see what is inside it.

```{r}

inspect(households)

```

There's a lot to unpack there, but we'll come back to that 

Now inspect an individual variable in detail

```{r}

inspect_variable(households, 'Construction.material')

```

And validate it

```{r}

validate(households)

```

Aha - something is wrong. Let's follow the advice and fix it.

```{r}

households <- households %>% set_entity_name('household')
validate(households)

```

Yay - now it validates. Let's have a closer look inside:

```{r}

inspect(households)

```

You can see that some top-level information about the entity is now filled in:

```
### Entity-level metadata ###

Field                 Value      
--------------------  -----------
name                  household  
description           NA         
display_name          household  
display_name_plural   households 
parent_name           NA         
```




